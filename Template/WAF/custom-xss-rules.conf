# Custom XSS Protection Rules
# Enhanced cross-site scripting detection

SecRule ARGS "@detectXSS" \
    "id:11000,\
    phase:2,\
    block,\
    log,\
    msg:'XSS Attack Detected',\
    severity:CRITICAL,\
    tag:'application-multi',\
    tag:'language-multi',\
    tag:'platform-multi',\
    tag:'attack-xss',\
    setvar:'tx.xss_score=+%{tx.critical_anomaly_score}'"

SecRule ARGS "@rx (?i:<script[^>]*>[\s\S]*?</script>)" \
    "id:11001,\
    phase:2,\
    block,\
    log,\
    msg:'XSS - Script Tag Detected',\
    severity:CRITICAL"

SecRule ARGS "@rx (?i:on(load|error|click|mouse|focus|blur|change|submit)=)" \
    "id:11002,\
    phase:2,\
    block,\
    log,\
    msg:'XSS - Event Handler Detected',\
    severity:CRITICAL"

SecRule ARGS "@rx (?i:javascript:)" \
    "id:11003,\
    phase:2,\
    block,\
    log,\
    msg:'XSS - JavaScript Protocol',\
    severity:CRITICAL"

SecRule ARGS "@rx (?i:<iframe|<embed|<object)" \
    "id:11004,\
    phase:2,\
    block,\
    log,\
    msg:'XSS - Dangerous HTML Tags',\
    severity:WARNING"
