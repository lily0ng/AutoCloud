# Custom LFI/RFI Protection Rules
# Local and Remote File Inclusion detection

SecRule ARGS "@rx (?i:(\.\.\/|\.\.\\\\))" \
    "id:13000,\
    phase:2,\
    block,\
    log,\
    msg:'Path Traversal Attack',\
    severity:CRITICAL,\
    tag:'attack-lfi'"

SecRule ARGS "@rx (?i:(\/etc\/passwd|\/etc\/shadow|\/etc\/hosts|boot\.ini|win\.ini))" \
    "id:13001,\
    phase:2,\
    block,\
    log,\
    msg:'LFI - Sensitive File Access',\
    severity:CRITICAL"

SecRule ARGS "@rx (?i:(https?|ftps?|php|data|file|glob|phar|zlib|zip|rar):\/\/)" \
    "id:13002,\
    phase:2,\
    block,\
    log,\
    msg:'RFI - Remote File Inclusion',\
    severity:CRITICAL,\
    tag:'attack-rfi'"

SecRule ARGS "@rx (?i:(\%00|\\x00))" \
    "id:13003,\
    phase:2,\
    block,\
    log,\
    msg:'Null Byte Injection',\
    severity:CRITICAL"
