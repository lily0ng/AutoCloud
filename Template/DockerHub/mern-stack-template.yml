---
# MERN Stack Template - MongoDB + Express + React + Node.js
version: '3.8'
services:
  mongodb:
    image: mongo:6.0
    restart: always
    ports: ["27017:27017"]
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: ${MONGO_PASSWORD:-pass123}
    volumes: [mongodb_data:/data/db]
  backend:
    image: node:18-alpine
    restart: always
    working_dir: /app
    ports: ["5000:5000"]
    environment:
      MONGODB_URI: mongodb://admin:${MONGO_PASSWORD:-pass123}@mongodb:27017/merndb?authSource=admin
      PORT: 5000
    volumes: [./backend:/app, /app/node_modules]
    command: sh -c "npm install && npm start"
  frontend:
    image: node:18-alpine
    restart: always
    working_dir: /app
    ports: ["3000:3000"]
    environment:
      REACT_APP_API_URL: http://localhost:5000
    volumes: [./frontend:/app, /app/node_modules]
    command: sh -c "npm install && npm start"
volumes:
  mongodb_data:
