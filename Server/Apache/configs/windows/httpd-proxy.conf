# Windows Apache Configuration

# Port Configuration
Listen 80
Listen 443
Listen 8080
Listen 8443
Listen 3000

# Load Required Modules
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
LoadModule ssl_module modules/mod_ssl.so

# Proxy Configuration
<IfModule mod_proxy.c>
    ProxyRequests Off
    ProxyPreserveHost On

    # Security Settings
    <Proxy *>
        Require all granted
    </Proxy>

    # Application Proxies
    ProxyPass /app1 http://localhost:3000
    ProxyPassReverse /app1 http://localhost:3000

    ProxyPass /api http://localhost:8080/api
    ProxyPassReverse /api http://localhost:8080/api

    # SSL Configuration
    <VirtualHost *:443>
        SSLEngine on
        SSLCertificateFile "conf/ssl/server.crt"
        SSLCertificateKeyFile "conf/ssl/server.key"
        
        ProxyPass /secure https://localhost:8443
        ProxyPassReverse /secure https://localhost:8443
    </VirtualHost>

    # Load Balancer
    <Proxy "balancer://mycluster">
        BalancerMember "http://localhost:8081"
        BalancerMember "http://localhost:8082"
        ProxySet lbmethod=byrequests
    </Proxy>
</IfModule>
