# CentOS-specific Datadog Agent Configuration
api_key: "<YOUR_DATADOG_API_KEY>"
site: "datadoghq.com"

# CentOS System Monitoring
logs_enabled: true
logs_config:
  processing_rules:
    - type: mask_sequences
      name: "mask_credentials"
      pattern: "(password|secret|key)(['\"]:\s*['\"])\w+"
      replacement: "\\1\\2*****"

# CentOS-specific log collection
logs:
  - type: file
    path: /var/log/messages
    service: centos-system
    source: syslog
  - type: file
    path: /var/log/secure
    service: centos-auth
    source: auth
  - type: file
    path: /var/log/yum.log
    service: centos-packages
    source: yum

# SELinux configuration
selinux_config:
  enabled: true
  context: system_u:system_r:datadog_agent_t:s0

# Process monitoring
process_config:
  enabled: true
  intervals:
    process_realtime: 10
    process: 30

# CentOS-specific checks
auto_conf_images: true
container_include:
  - "image:centos"
  - "image:redhat/*"

# System Probe for CentOS
system_probe_config:
  enabled: true
  sysprobe_socket: /sys/kernel/debug/tracing
  enable_tcp_monitoring: true
  enable_udp_monitoring: true

# CentOS-specific integrations
integrations:
  systemd:
    init_config:
    instances:
      - unit_names:
          - sshd.service
          - firewalld.service
          - NetworkManager.service
  selinux:
    init_config:
    instances:
      - 
